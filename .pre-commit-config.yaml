# Baseline pre-commit configuration for Red Hat AI-Ready repositories
#
# This config includes:
# 1. Red Hat security/compliance hooks (rh-pre-commit)
# 2. AI-readiness hooks from this repository
#
# To use this config:
#   1. Copy this file to your repo root as .pre-commit-config.yaml
#   2. Run: pre-commit install
#   3. Run: pre-commit install --hook-type pre-push  (for AGENTS.md validation)
#   4. Run: pre-commit run --all-files (to test)
#
# See: https://pre-commit.com/

repos:
  # Red Hat security and compliance hooks
  - repo: https://gitlab.cee.redhat.com/infosec-public/developer-workbench/tools
    rev: rh-pre-commit-2.3.2  # Use specific tag (https://gitlab.cee.redhat.com/infosec-public/developer-workbench/tools/-/tags)
    hooks:
      - id: rh-pre-commit

  # AI-readiness hooks
  - repo: https://github.com/openshift-hyperfleet/rh-hooks-ai
    rev: v1.0.3  # Updated automatically by release workflow
    hooks:
      - id: check-rh-precommit
      - id: validate-agents-md  # Runs on git push, requires AGENTS.md - comment out if not using
      - id: ai-attribution-reminder
      # - id: check-version  # Optional: Checks for updates once per 24h (non-blocking)

  # Python code quality hooks
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.14.8
    hooks:
      # Run the linter with auto-fix
      - id: ruff
        args: [--fix]
      # Run the formatter
      - id: ruff-format

  # Type checking
  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.13.0
    hooks:
      - id: mypy
        args: [--config-file=src/api/pyproject.toml]
        additional_dependencies: []
        files: ^src/api/

  # Run pytest on pre-push
  - repo: local
    hooks:
      - id: pytest
        name: pytest
        entry: bash -c 'cd src/api && pytest'
        language: system
        pass_filenames: false
        stages: [pre-push]
