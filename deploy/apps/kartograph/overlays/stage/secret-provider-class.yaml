---
# SecretProviderClass for Postgres credentials
apiVersion: secrets-store.csi.x-k8s.io/v1
kind: SecretProviderClass
metadata:
  name: kartograph-db-vault
spec:
  provider: vault
  secretObjects:
    - secretName: kartograph-db-credentials
      type: Opaque
      data:
        - objectName: db-password
          key: password
  parameters:
    vaultAddress: "https://vault.corp.redhat.com"
    roleName: "kartograph-stage"
    objects: |
      - objectName: "db-password"
        secretPath: "hcm-ai/data/kartograph/stage/postgres"
        secretKey: "password"
---
# SecretProviderClass for SpiceDB credentials
apiVersion: secrets-store.csi.x-k8s.io/v1
kind: SecretProviderClass
metadata:
  name: kartograph-spicedb-vault
spec:
  provider: vault
  secretObjects:
    - secretName: kartograph-spicedb-credentials
      type: Opaque
      data:
        - objectName: spicedb-preshared-key
          key: preshared-key
        - objectName: spicedb-datastore-uri
          key: datastore-uri
  parameters:
    vaultAddress: "https://vault.corp.redhat.com"
    roleName: "kartograph-stage"
    objects: |
      - objectName: "spicedb-preshared-key"
        secretPath: "hcm-ai/data/kartograph/stage/spicedb"
        secretKey: "SPICEDB_PRESHARED_KEY"
      - objectName: "spicedb-datastore-uri"
        secretPath: "hcm-ai/data/kartograph/stage/spicedb"
        secretKey: "SPICEDB_DATASTORE_CONN_URI"
